<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script type="text/javascript" src="../js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="../js/vue.min.js"></script>
    <script>
        var renewJson = {"actCodeSku":{"宝贝团回馈":{"45":{"url":"http://tb.cn/AZfCEPx","unit":"季度","originalPrice":"78"},"68":{"url":"http://tb.cn/cplCEPx","unit":"半年","originalPrice":"128"},"128":{"url":"http://tb.cn/uhyCEPx","unit":"年","originalPrice":"168"},"sms":{"unitPrice":"4","price":"1000","count":"25000","discount":"4","url":"http://promotion.baobeituan.com/purchase/smsPay.jsp?orderConfigType=9"}},"宝贝团谢礼":{"30":{"url":"http://tb.cn/t3K4EPx","unit":"季度","originalPrice":"78"},"52":{"url":"http://tb.cn/FQO4EPx","unit":"半年","originalPrice":"128"},"90":{"url":"http://tb.cn/hWK5EPx","unit":"年","originalPrice":"168"},"sms":{"unitPrice":"4","price":"500","count":"12500","discount":"4","url":"http://promotion.baobeituan.com/purchase/smsPay.jsp?orderConfigType=7"}},"惠聚双11":{"30":{"url":"http://tb.cn/XnlNEPx","unit":"季度","originalPrice":"78"},"55":{"url":"http://tb.cn/kLtNEPx","unit":"半年","originalPrice":"128"},"99":{"url":"http://tb.cn/L6BOEPx","unit":"年","originalPrice":"168"},"sms":{"unitPrice":"4","price":"500","count":"12500","discount":"4","url":"http://promotion.baobeituan.com/purchase/smsPay.jsp?orderConfigType=7"}},"感恩破冰价":{"55":{"url":"http://tb.cn/uyAOEPx","unit":"季度","originalPrice":"78"},"99":{"url":"http://tb.cn/8NOOEPx","unit":"半年","originalPrice":"128"},"138":{"url":"http://tb.cn/P8ROEPx","unit":"年","originalPrice":"168"},"sms":{"unitPrice":"4","price":"1000","count":"25000","discount":"4","url":"http://promotion.baobeituan.com/purchase/smsPay.jsp?orderConfigType=9"}}},"defaultSku":{"64":{"unit":"季度","originalPrice":"78","url":"http://tb.cn/4W0REPx"},"118":{"unit":"半年","originalPrice":"128","url":"http://tb.cn/cupQEPx"},"148":{"unit":"年","originalPrice":"168","url":"http://tb.cn/zjlQEPx"},"sms":{"unitPrice":"5","price":"1000","count":"20000","discount":"5","url":"http://promotion.baobeituan.com/purchase/smsPay.jsp?orderConfigType=10"},},"version":31};
    </script>
    <style>
       html{overflow:hidden;}html,body{width:100%;height:100%;margin:0;font-family:Microsoft Yahei;}ul,li{margin:0;padding:0;list-style-type:none;}a{text-decoration:none;}.container{position:relative;width:100%;height:100%;background:url(bg.png) no-repeat;}.mask{position:absolute;width:100%;height:100%;top:0;left:0;background-color:rgba(0,0,0,0.6);}.cont{position:absolute;width:787px;height:668px;top:50%;left:50%;margin-top:-393px;margin-left:-334px;background:url(https://img.alicdn.com/imgextra/i3/17157061/TB229j_bCOI.eBjy1zkXXadxFXa-17157061.png) no-repeat;}.prize-list{float:left;margin-top:260px;margin-left:125px;}.prize-list li{float:left;width:140px;height:86px;background:url(https://img.alicdn.com/imgextra/i2/17157061/TB2dPMGatAvbeFjSspbXXbcOFXa-17157061.png) no-repeat;margin:0 20px;}.prize-list li .prize-link{float:left;display:block;width:100%;height:100%;}.prize-list li .prize{float:left;width:66px;color:#ff0883;font-size:36px;text-align:center;margin:4px;}.prize-list li .original-prize{float:left;font-size:12px;color:#381b50;margin-top:10px;}.prize-list li .unit{font-size:14px;}.prize-list li .num{display:block;text-decoration:line-through;}.rotate-transition{transform:rotateX(360deg);-webkit-transform:rotateX(360deg);-moz-transform:rotateX(360deg);-ms-transform:rotateX(360deg);transition:transform 1.5s ease-in-out;-webkit-transition:-webkit-transform 1.5s ease-in-out;-moz-transition:-moz-transform 1.5s ease-in-out;-ms-transition:-ms-transform 1.5s ease-in-out;}.rotate-enter{transform:rotateX(0);-webkit-transform:rotateX(0);-moz-transform:rotateX(0);-ms-transform:rotateX(0);}.rotate-leave{display:none;}.msg-num{float:left;width:330px;height:62px;margin-top:20px;margin-left:330px;}.msg-num a{display:block;width:100%;height:100%;font-size:34px;color:#ff0883;}.msg-num .unit{font-size:14px;color:#381b50;}.msg-num .unit-price{display:block;font-size:14px;color:#381b50;margin-left:30px;}#renewPopup .form{float:left;width:100%;margin-top:10px;text-align:center;}#renewPopup .item{width:360px;margin:0 auto;font-size:14px;color:#fff;margin-bottom:5px;text-align:left;}#renewPopup .input-text{outline:none;padding:5px;border:1px solid #fff;border-radius:4px;box-shadow:2px 2px 4px rgba(0,0,0,0.15);-webkit-box-shadow:2px 2px 4px rgba(0,0,0,0.15);-moz-box-shadow:2px 2px 4px rgba(0,0,0,0.15);-ms-box-shadow:2px 2px 4px rgba(0,0,0,0.15);}#renewPopup .password{display:inline-block;width:150px;background-color:#fff;}#renewPopup .item a{padding:5px;font-size:12px;background-color:#fff;color:#8b5aef;border-radius:4px;margin-left:10px;margin-right:5px;box-shadow:2px 2px 4px rgba(0,0,0,0.15);-webkit-box-shadow:2px 2px 4px rgba(0,0,0,0.15);-moz-box-shadow:2px 2px 4px rgba(0,0,0,0.15);-ms-box-shadow:2px 2px 4px rgba(0,0,0,0.15);}#renewPopup .item .title{display:inline-block;width:90px;}#renewPopup .switch{float:left;margin-left:486px;margin-top:56px;}#renewPopup .switch a{color:#fff;}#renewPopup .switch a:hover{text-decoration:underline;}#renewPopup .close-renewPopup{float:right;display:inline-block;width:40px;height:40px;}#renewPopup input{color:#333;}
    </style>
</head>
<body>
    <div class="container">
        <div class="mask"></div>
        <div class="cont" id="renewPopup">
            <a href="javascript:;" class="close-renewPopup" @click="close"></a>
            <ul class="prize-list">
                <li v-for="(key, val) of priceList" v-if="key!='sms'" transition="rotate">
                    <a :href="priceList[key].url" class="prize-link" target="_blank">
                        <span class="prize">{{key}}</span>
                        <span class="original-prize">
                            <span class="unit">元/{{priceList[key].unit}}</span>
                            <span class="num">原价：{{priceList[key].originalPrice}}</span>
                        </span>
                    </a>
                </li>
            </ul>
            <div class="msg-num">
               <a :href="priceList.sms.url" target="_blank">{{priceList.sms.count}}条<span class="unit">/{{priceList.sms.price}}元</span><span class="unit-price">（每条只要{{priceList.sms.unitPrice}}分钱）</span></a>
            </div>
            <div class="switch">
                <a href="javascript:;" class="switch-btn" @click="switch">{{switchText}}</a>
            </div>
            <div class="form" v-if="hasPassword">
                <div class="item"><span class="title">输入口令：</span><input type="text" class="password input-text" v-model="password" @keyup.enter="confirmPassword"><a href="javascript:;" @click="confirmPassword">确定</a></div>
            </div>
            <div class="form" v-if="!hasPassword">
                <div class="item"><span class="title">输入手机号：</span><input class="password input-text" type="text" v-model="phoneNum" @keyup.enter="getPassword(phoneNum)"><a href="javascript:;" @click="getPassword(phoneNum)">{{getPasswordBtn}}</a></div>
                <div class="item"><span class="title">输入口令：</span><input type="text" class="password input-text" v-model="password" @keyup.enter="confirmPassword"><a href="javascript:;" @click="confirmPassword">使用口令</a>
                </div>
            </div>
        </div>
    </div>
    <script>
        var Renew = new Vue({
            el: '#renewPopup',
            data: {
                renewJson: renewJson,
                hasPassword: true,
                priceList: renewJson.defaultSku,
                switchText: '没有口令？点我获取！',
                password: '',
                defaultSku: '',
                phoneNum: '',
                getPasswordBtn: '获取口令'
            },
            methods: {
                switch: function(){
                    this.hasPassword = !this.hasPassword;
                    this.hasPassword ? this.switchText = '没有口令？点我获取！' : this.switchText = '点击返回！';
                    
                },
                confirmPassword: function(){
                    var that = this,
                        passwordList = Object.keys(that.renewJson.actCodeSku),
                        falg = false,
                        len = passwordList.length;
                    passwordList.forEach(function(val, index){
                        if (val === that.password) {
                            that.priceList = renewJson.actCodeSku[val];
                            falg = true;
                            if (val === '宝贝团谢礼') {
                                $.ajax({
                                    url: 'http://promotion.baobeituan.com/inneract/inner-act!presentVersion.action',
                                    type: 'GET',
                                    dataType: 'json',
                                    success: function(data){
                                        Util.notify(data.message);
                                    }
                                });
                            }
                        }
                    })
                    if (!falg) {
                        alert('请输入正确的口令！');
                    }
                },
                close: function(){

                },
                getPassword: function(number){
                    var that = this;
                    var getCookie = function(name){
                        var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");
                        if(arr=document.cookie.match(reg))
                        return unescape(arr[2]);
                        else
                        return null;
                    };
                    if(!number == '' || number == undefined || number == null){
                        if (!!getCookie('getPassword')) {
                            alert('请在60秒后再发送！');
                        }else if (!isNaN(number)) {
                            $.ajax({
                                url: 'http://promotion.baobeituan.com/inneract/inner-act!getActCode.action?mobileNum=' + number,
                                type: 'POST',
                                success: function(data){
                                    if (data.status == 0) {
                                        alert(data.message)
                                    }else{
                                        document.cookie = 'getPassword = 1; max-age=60';
                                        var time = 60;
                                        var countdown = setInterval(function(){
                                            time--;
                                             if (time >= 0) {
                                                that.getPasswordBtn = '已发送（'+ time +'）';
                                            }else{
                                                clearInterval(countdown);
                                                that.getPasswordBtn = '获取口令';
                                            }
                                        }, 1000)
                                        alert('发送成功，请注意查收短信！');
                                    }
                                }
                            })
                        }else{
                            alert('请输入您的手机号');
                        }
                    }else{
                        alert('请输入您的手机号');
                    }
                }
            }
        })
    </script>
</body>
</html>